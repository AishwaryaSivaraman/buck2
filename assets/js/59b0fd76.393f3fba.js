"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5002],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var s=i(96540);const t={},l=s.createContext(t);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(l.Provider,{value:n},e.children)}},41885:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"prelude/rules/apple_bundle","title":"apple_bundle","description":"name","source":"@site/../docs/prelude/rules/apple_bundle.md","sourceDirName":"prelude/rules","slug":"/prelude/rules/apple_bundle","permalink":"/docs/prelude/rules/apple_bundle","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ruleSidebar","previous":{"title":"apple_binary","permalink":"/docs/prelude/rules/apple_binary"},"next":{"title":"apple_library","permalink":"/docs/prelude/rules/apple_library"}}');var t=i(74848),l=i(28453);i(56289);const o={},r="apple_bundle",a={},d=[{value:"name",id:"name",level:2},{value:"Parameters",id:"parameters",level:4},{value:"Details",id:"details",level:4}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"apple_bundle",children:"apple_bundle"})}),"\n",(0,t.jsx)(n.h2,{id:"name",children:"name"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"def name(\n    *,\n    name: str,\n    default_target_platform: None | str = ...,\n    target_compatible_with: list[str] = ...,\n    compatible_with: list[str] = ...,\n    exec_compatible_with: list[str] = ...,\n    visibility: list[str] = ...,\n    within_view: list[str] = ...,\n    metadata: OpaqueMetadata = ...,\n    tests: list[str] = ...,\n    modifiers: OpaqueMetadata = ...,\n    _apple_platforms: dict[str, str] = ...,\n    _apple_toolchain: str = ...,\n    _apple_tools: str = ...,\n    _apple_xctoolchain: str = ...,\n    _apple_xctoolchain_bundle_id: str = ...,\n    _bundling_cache_buster: None | str = ...,\n    _bundling_log_file_enabled: bool = ...,\n    _bundling_log_file_level: None | str = ...,\n    _code_signing_configuration: None | str = ...,\n    _codesign_entitlements: None | str = ...,\n    _codesign_identities_command_override: None | str = ...,\n    _codesign_type: None | str = ...,\n    _compile_resources_locally_override: None | bool = ...,\n    _dsymutil_extra_flags: list[str],\n    _dsymutil_verify_dwarf: str,\n    _embed_provisioning_profile_when_adhoc_code_signing: None | bool = ...,\n    _fast_adhoc_signing_enabled_default: bool = ...,\n    _fast_provisioning_profile_parsing_enabled: bool = ...,\n    _incremental_bundling_enabled: bool = ...,\n    _info_plist_identify_build_system_default: bool = ...,\n    _profile_bundling_enabled: bool = ...,\n    _provisioning_profiles: str = ...,\n    _resource_bundle: None | str = ...,\n    _skip_adhoc_resigning_scrubbed_frameworks_default: bool = ...,\n    _skip_adhoc_resigning_scrubbed_frameworks_override: None | bool = ...,\n    _strict_provisioning_profile_search_default: bool = ...,\n    _use_entitlements_when_adhoc_code_signing: None | bool = ...,\n    asset_catalogs_compilation_options: dict[str, typing.Any] = ...,\n    binary: None | str = ...,\n    bundle_type: None | str = ...,\n    code_signing_configuration: None | str = ...,\n    codesign_flags: list[str] = ...,\n    codesign_identity: None | str = ...,\n    codesign_type: None | str = ...,\n    contacts: list[str] = ...,\n    copy_public_framework_headers: None | bool = ...,\n    debug_artifacts_validators: dict[str, (str, str)] = ...,\n    default_host_platform: None | str = ...,\n    default_platform: None | str = ...,\n    deps: list[str] = ...,\n    dsym_uses_parallel_linker: bool = ...,\n    embed_provisioning_profile_when_adhoc_code_signing: bool = ...,\n    embed_xctest_frameworks: bool = ...,\n    extension: str,\n    fast_adhoc_signing_enabled: None | bool = ...,\n    ibtool_flags: None | list[str] = ...,\n    incremental_bundling_enabled: None | bool = ...,\n    info_plist: str,\n    info_plist_identify_build_system: None | bool = ...,\n    info_plist_substitutions: dict[str, str] = ...,\n    labels: list[str] = ...,\n    licenses: list[str] = ...,\n    module_map: None | str = ...,\n    platform_binary: None | list[(str, str)] = ...,\n    privacy_manifest: None | str = ...,\n    product_name: None | str = ...,\n    product_name_from_module_name: bool = ...,\n    propagated_target_sdk_version: None | str = ...,\n    provisioning_profile_filter: None | str = ...,\n    resource_group: None | str = ...,\n    resource_group_map: None | str = ...,\n    selective_debugging: None | str = ...,\n    skip_adhoc_resigning_scrubbed_frameworks: None | bool = ...,\n    skip_copying_swift_stdlib: None | bool = ...,\n    split_arch_dsym: bool = ...,\n    strict_provisioning_profile_search: None | bool = ...,\n    try_skip_code_signing: None | bool = ...,\n    universal: None | bool = ...,\n    use_entitlements_when_adhoc_code_signing: bool = ...,\n    validation_deps: list[str] = ...,\n    versioned_macos_bundle: bool = ...,\n    xcode_product_type: None | str = ...,\n    xcode_scheme_settings: None | str = ...,\n) -> None\n"})}),"\n",(0,t.jsxs)(n.p,{children:["An ",(0,t.jsx)(n.code,{children:"apple_bundle()"})," rule takes an Apple binary and all of the resources and asset catalogs in the rule's transitive dependencies and generates a bundle containing all of those files. Optionally the generated bundle can also be signed using specified provisioning profiles."]}),"\n",(0,t.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"name"}),": name of the target"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"default_target_platform"}),": specifies the default target platform, used when no platforms are specified on the command line"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"target_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"exec_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with an execution platform"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"visibility"}),": a list of visibility patterns restricting what targets can depend on this one"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"within_view"}),": a list of visibility patterns restricting what this target can depend on"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"metadata"}),": a key-value map of metadata associated with this target"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"tests"}),": a list of targets that provide tests for this one"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"modifiers"}),": an array of modifiers associated with this target"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"asset_catalogs_compilation_options"}),": A dict holding parameters for asset catalogs compiler (actool). Its options include:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"notices"})," (defaults to ",(0,t.jsx)(n.code,{children:"True"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"warnings"})," (defaults to ",(0,t.jsx)(n.code,{children:"True"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"errors"})," (defaults to ",(0,t.jsx)(n.code,{children:"True"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"compress_pngs"})," (defaults to ",(0,t.jsx)(n.code,{children:"True"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"optimization"})," (defaults to ",(0,t.jsx)(n.code,{children:"'space'"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"output_format"})," (defaults to ",(0,t.jsx)(n.code,{children:"'human-readable-text'"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"extra_flags"})," (defaults to ",(0,t.jsx)(n.code,{children:"[]"}),")"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"deps"}),": A list of dependencies of this bundle as build targets. You can embed application extensions by specifying the extension's bundle target. To include a WatchKit app, append the flavor ",(0,t.jsx)(n.code,{children:"#watch"})," to the target specification. Buck will automatically substitute the appropriate platform flavor (either ",(0,t.jsx)(n.code,{children:"watchsimulator"})," or ",(0,t.jsx)(n.code,{children:"watchos"}),") based on the parent."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"extension"}),": The extension of the generated bundle. For example ",(0,t.jsx)(n.code,{children:"'app'"})," for an application bundle or ",(0,t.jsx)(n.code,{children:"'appex'"})," for an application extension bundle."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"ibtool_flags"}),": List of flags to be passed to ibtool during interface builder file compilation."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"info_plist"}),": A path to an ",(0,t.jsx)(n.code,{children:"Info.plist"})," file that will be placed in the bundle. The specified file will be processed by substituting variable names with their values (see ",(0,t.jsx)(n.code,{children:"info_plist_substitutions"})," for more information)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"info_plist_substitutions"}),": A dictionary that assigns variable names to their values. It is used for variable substitution when processing the file specified in ",(0,t.jsx)(n.code,{children:"info_plist"}),". For example if this argument is set to ",(0,t.jsx)(n.code,{children:"{'VAR': 'MyValue'}"}),", then each occurrence of ",(0,t.jsx)(n.code,{children:"$(VAR)"})," or ",(0,t.jsx)(n.code,{children:"${VAR}"})," in the file will be replaced by ",(0,t.jsx)(n.code,{children:"MyValue"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"privacy_manifest"}),": A path to an ",(0,t.jsx)(n.code,{children:".xcprivacy"})," file that will be placed in the bundle."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"product_name"}),': The name of the resulting bundle and binary. The setting behaves like PRODUCT_NAME Xcode build setting. For example, if your rule is named "MyApp" and extension is "app", by default buck will generate MyApp.app bundle. But if you will set product name to "SuperApp", bundle will get "SuperApp.app" name.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"xcode_scheme_settings"}),": Optional settings to set on schemes when this target is represented in Xcode."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"details",children:"Details"}),"\n",(0,t.jsxs)(n.p,{children:["Code signing will embed entitlements pointed to by the ",(0,t.jsx)(n.code,{children:"entitlements_file"})," arg in\nthe bundle's ",(0,t.jsx)(n.code,{children:"apple_binary"}),". This is the preferred way to specify entitlements\nwhen building with Buck."]}),"\n",(0,t.jsxs)(n.p,{children:["If the entitlements file is not present, it falls back to the ",(0,t.jsx)(n.code,{children:"CODE_SIGN_ENTITLEMENTS"})," entry in\n",(0,t.jsx)(n.code,{children:"info_plist_substitutions"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["If after these checks, an entitlements file is still not specified, it will be derived based\non the entitlements of the selected provisioning profile. Provisioning profiles will be selected\nfrom profiles pointed to by ",(0,t.jsx)(n.code,{children:"apple.provisioning_profile_search_path"}),", based on a\nnon-expired profile that matches the bundle id and entitlements."]}),"\n",(0,t.jsxs)(n.p,{children:["Code signing will embed entitlements pointed to by the ",(0,t.jsx)(n.code,{children:"CODE_SIGN_ENTITLEMENTS"})," entry in\n",(0,t.jsx)(n.code,{children:"info_plist_substitutions"}),". If an entitlements file is omitted, it will be derived based\non the entitlements of the selected provisioning profile. Provisioning profiles will be selected\nfrom profiles pointed to by ",(0,t.jsx)(n.code,{children:"apple.provisioning_profile_search_path"}),", based on a\nnon-expired profile that matches the bundle id and entitlements."]}),"\n",(0,t.jsx)(n.p,{children:"Examples:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\napple_bundle(\n  name = 'AppBundle',\n  binary = ':MyBinary',\n  extension = 'app',\n  info_plist = 'Info.plist',\n)\n\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\n# iOS app with embedded WatchOS 2.0 app/extension\napple_bundle(\n  name = 'DemoWatchAppExtension',\n  binary = ':DemoWatchAppExtensionBinary',\n  extension = 'appex',\n  info_plist = 'WatchExtension/Resources/Info.plist',\n)\n\napple_bundle(\n  name = 'DemoWatchApp',\n  binary = ':DemoWatchAppBinary',\n  deps = [':DemoWatchAppResources', ':DemoWatchAppExtension'],\n  extension = 'app',\n  info_plist = 'WatchApplication/Info.plist',\n)\n\napple_bundle(\n  name = 'DemoApp',\n  binary = ':DemoAppBinary',\n  deps = [':DemoWatchApp#watch'],\n  extension = 'app',\n  info_plist = 'Info.plist',\n)\n\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\n# iOS app using safeAreaInsets delivering to iOS 9.x\napple_bundle(\n  name = 'DemoIBApp',\n  binary = ':DemoIBAppBinary',\n  deps = [':DemoIBAppResources'],\n  extension = 'app',\n  ibtool_flags = [\"--minimum-deployment-target\", \"9.0\"],\n  info_plist = 'Info.plist',\n)\n\n"})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);