"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6022],{13948:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"prelude/rules/http_file","title":"http_file","description":"name","source":"@site/../docs/prelude/rules/http_file.md","sourceDirName":"prelude/rules","slug":"/prelude/rules/http_file","permalink":"/docs/prelude/rules/http_file","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ruleSidebar","previous":{"title":"http_archive","permalink":"/docs/prelude/rules/http_archive"},"next":{"title":"jar_genrule","permalink":"/docs/prelude/rules/jar_genrule"}}');var a=n(74848),s=n(28453);n(56289);const r={},l="http_file",o={},d=[{value:"name",id:"name",level:2},{value:"Parameters",id:"parameters",level:4},{value:"Details",id:"details",level:4}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"http_file",children:"http_file"})}),"\n",(0,a.jsx)(t.h2,{id:"name",children:"name"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"def name(\n    *,\n    name: str,\n    default_target_platform: None | str = ...,\n    target_compatible_with: list[str] = ...,\n    compatible_with: list[str] = ...,\n    exec_compatible_with: list[str] = ...,\n    visibility: list[str] = ...,\n    within_view: list[str] = ...,\n    metadata: OpaqueMetadata = ...,\n    tests: list[str] = ...,\n    modifiers: OpaqueMetadata = ...,\n    _apple_platforms: dict[str, str] = ...,\n    contacts: list[str] = ...,\n    default_host_platform: None | str = ...,\n    executable: None | bool = ...,\n    labels: list[str] = ...,\n    licenses: list[str] = ...,\n    out: None | str = ...,\n    sha1: None | str = ...,\n    sha256: None | str = ...,\n    size_bytes: None | int = ...,\n    urls: list[str] = ...,\n    vpnless_urls: list[str] = ...,\n) -> None\n"})}),"\n",(0,a.jsxs)(t.p,{children:["An ",(0,a.jsx)(t.code,{children:"http_file()"})," rule is used to download files from the Internet to be used as dependencies for other rules. This rule only downloads single files, and can optionally make them executable (see ",(0,a.jsx)(t.code,{children:"http_file()executable"}),") These rules are downloaded by running ",(0,a.jsx)(t.code,{children:"fetch"}),", or can be downloaded as part of ",(0,a.jsx)(t.code,{children:"build"})," by setting ",(0,a.jsx)(t.code,{children:".buckconfig"})]}),"\n",(0,a.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"name"}),": name of the target"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"default_target_platform"}),": specifies the default target platform, used when no platforms are specified on the command line"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"target_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with a configuration"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"exec_compatible_with"}),": a list of constraints that are required to be satisfied for this target to be compatible with an execution platform"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"visibility"}),": a list of visibility patterns restricting what targets can depend on this one"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"within_view"}),": a list of visibility patterns restricting what this target can depend on"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"metadata"}),": a key-value map of metadata associated with this target"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"tests"}),": a list of targets that provide tests for this one"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"modifiers"}),": an array of modifiers associated with this target"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"executable"}),": Whether or not the file should be made executable after downloading. If true, this can also be used via ",(0,a.jsx)(t.code,{children:"run"})," and the ",(0,a.jsx)(t.code,{children:"$(exe )"}),"\xa0",(0,a.jsx)(t.code,{children:"string parameter macros"})]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"out"}),": An optional name to call the downloaded artifact. Buck will generate a default name if one is not provided that uses the ",(0,a.jsx)(t.code,{children:"name"})," of the rule."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"sha256"}),": The ",(0,a.jsx)(t.a,{href:"//wikipedia.org/wiki/SHA-2",children:(0,a.jsx)(t.code,{children:"SHA-256"})})," hash of the downloaded artifact. Buck verifies this is correct and fails the fetch command if it doesn't match in order to guarantee repeatable builds."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"urls"}),': A list of urls to attempt to download from. They are tried in order, and subsequent ones are only tried if the download fails. If validation fails, a new URL is not used. Supported protocols are "http", "https", and "mvn".']}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"vpnless_urls"}),": Additional URLs from which this resource can be downloaded when off VPN. Meta-internal only."]}),"\n"]}),"\n",(0,a.jsx)(t.h4,{id:"details",children:"Details"}),"\n",(0,a.jsx)(t.p,{children:"Examples:"}),"\n",(0,a.jsxs)(t.p,{children:["Using ",(0,a.jsx)(t.code,{children:"http_file()"}),", third party packages can be downloaded from\nan ",(0,a.jsx)(t.code,{children:"https"})," URL and used in java libraries."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"\nhttp_file(\n  name = 'guava-23-bin',\n  urls = [\n    'http://search.maven.org/remotecontent?filepath=com/google/guava/guava/23.0/guava-23.0.jar',\n  ],\n  sha256 = '7baa80df284117e5b945b19b98d367a85ea7b7801bd358ff657946c3bd1b6596',\n)\nhttp_file(\n  name = 'guava-23-sources',\n  urls = [\n    'http://search.maven.org/remotecontent?filepath=com/google/guava/guava/23.0/guava-23.0-sources.jar',\n  ],\n  sha256 = '37fe8ba804fb3898c3c8f0cbac319cc9daa58400e5f0226a380ac94fb2c3ca14',\n)\n\nprebuilt_java_library(\n  name = 'guava-23',\n  binary_jar = ':guava-23-bin',\n  source_jar = ':guava-23-source',\n)\n\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Tooling can also be fetched with ",(0,a.jsx)(t.code,{children:"http_file()"})," and used by a ",(0,a.jsx)(t.code,{children:"genrule()"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"\ngenrule(\n  name=\"my-thrift-lib-cpp2\",\n  cmd=\"$(exe :thrift-compiler-bin) --gen cpp2 -o $OUT $(location //:thrift-file)\",\n  out=\"gen-cpp2\",\n)\n\nhttp_file(\n  name = 'thrift-compiler-bin',\n  url = 'https://internal-mirror.example.com/bin/thrift-compiler',\n  sha256 = 'c24932ccabb66fffb2d7122298f7f1f91e0b1f14e05168e3036333f84bdf58dc',\n  executable = True,\n)\n\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Here's an example of a ",(0,a.jsx)(t.code,{children:"http_file()"})," using a mvn URI which uses a Maven classifier."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"\nhttp_file(\n  name = 'guava-23-bin',\n  urls = [\n    'mvn:com.google.guava:guava:jar:23.0',\n  ],\n  sha256 = '7baa80df284117e5b945b19b98d367a85ea7b7801bd358ff657946c3bd1b6596',\n)\n\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var i=n(96540);const a={},s=i.createContext(a);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);